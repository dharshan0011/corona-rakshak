<!DOCTYPE html>
<html>
    <head>
        <title>Connect BT DEVICES</title> 
         <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0" />
    </head>
    <form>
      <!--Using clip from soundbible.com-->
        <audio id="chatAudio" > 
            <source src= "http://soundbible.com/2210-SOS-Morse-Code.html" type="audio/mpeg"> 
        </audio> 
          <button>Connect BT device</button>
    </form>

<script>
  // var deviceName = 'If want to connect to specific device, specify name'
  var alarmbeep = document.getElementById('BeepAudio');
  var danger = ["NO","PROBABLY-INFECTED","INFECTED"];
  var nodanger = ["YES","SAFE",];
  function isWebBluetoothEnabled() {
    if (!navigator.bluetooth) {
      // firefox not supported
      console.log('Web Bluetooth API is not available in this browser!')
      return false
    }

    return true
  }

  function getDeviceInfo() {
    let options = {
      acceptAllDevices: true // Option to accept all devices
    // to call specific device
    //  "filters": [
    //    { "name": deviceName }
    //  ]
    }

    console.log('Requesting Bluetooth Device...')
    navigator.bluetooth.requestDevice(options).then(device => {
      console.log('> Name: ' + device.name)
    }).catch(error => {
      console.log('Argh! ' + error)
    })
  }
  funtion alarm() {
      let op = {
        "alarm": [ {"al": danger} ]
      "no-alarm" : [ {"no-al" : nodanger} ]
    }
    if(alarm)
    {
       
        function play(){ 
            alarmbeep.play() 
      }
    }
  }
  document.querySelector('form').addEventListener('submit', function(event) {
    event.stopPropagation()
    event.preventDefault()

    if (isWebBluetoothEnabled()) {
      getDeviceInfo()
    }
  })

</script>
</html>
